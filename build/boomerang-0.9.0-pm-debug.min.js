function BOOMR_check_doc_domain(domain){var test;if(!domain){if(window.parent===window||!document.getElementById("boomr-if-as"))return;domain=document.domain}if(-1!==domain.indexOf(".")){try{return void(test=window.parent.document)}catch(err){document.domain=domain}try{return void(test=window.parent.document)}catch(err){domain=domain.replace(/^[\w\-]+\./,"")}BOOMR_check_doc_domain(domain)}}BOOMR_start=(new Date).getTime(),BOOMR_check_doc_domain(),function(w){var impl,boomr,d,myurl,createCustomEvent,dispatchEvent,visibilityState,visibilityChange;w.parent!==w&&document.getElementById("boomr-if-as")&&"script"===document.getElementById("boomr-if-as").nodeName.toLowerCase()&&(w=w.parent,myurl=document.getElementById("boomr-if-as").src),d=w.document,w.BOOMR||(w.BOOMR={}),BOOMR=w.BOOMR,BOOMR.version||(BOOMR.version="0.9",BOOMR.window=w,BOOMR.plugins||(BOOMR.plugins={}),function(){try{void 0!==new w.CustomEvent("CustomEvent")&&(createCustomEvent=function(e_name,params){return new w.CustomEvent(e_name,params)})}catch(ignore){}try{!createCustomEvent&&d.createEvent&&d.createEvent("CustomEvent")&&(createCustomEvent=function(e_name,params){var evt=d.createEvent("CustomEvent");return params=params||{cancelable:!1,bubbles:!1},evt.initCustomEvent(e_name,params.bubbles,params.cancelable,params.detail),evt})}catch(ignore){}!createCustomEvent&&d.createEventObject&&(createCustomEvent=function(e_name,params){var evt=d.createEventObject();return evt.type=evt.propertyName=e_name,evt.detail=params.detail,evt}),createCustomEvent||(createCustomEvent=function(){return void 0})}(),dispatchEvent=function(e_name,e_data,async){function dispatch(){d.dispatchEvent?d.dispatchEvent(ev):d.fireEvent&&d.fireEvent("onpropertychange",ev)}var ev=createCustomEvent(e_name,{detail:e_data});ev&&(async?BOOMR.setImmediate(dispatch):dispatch())},"undefined"!=typeof document.hidden?(visibilityState="visibilityState",visibilityChange="visibilitychange"):"undefined"!=typeof document.mozHidden?(visibilityState="mozVisibilityState",visibilityChange="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(visibilityState="msVisibilityState",visibilityChange="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(visibilityState="webkitVisibilityState",visibilityChange="webkitvisibilitychange"),impl={beacon_url:"",beacon_type:"AUTO",site_domain:w.location.hostname.replace(/.*?([^.]+\.[^.]+)\.?$/,"$1").toLowerCase(),user_ip:"",strip_query_string:!1,onloadfired:!1,handlers_attached:!1,events:{page_ready:[],page_unload:[],before_unload:[],dom_loaded:[],visibility_changed:[],before_beacon:[],onbeacon:[],xhr_load:[],click:[],form_submit:[]},public_events:{before_beacon:"onBeforeBoomerangBeacon",onbeacon:"onBoomerangBeacon",onboomerangloaded:"onBoomerangLoaded"},vars:{},errors:{},disabled_plugins:{},xb_handler:function(type){return function(ev){var target;ev||(ev=w.event),ev.target?target=ev.target:ev.srcElement&&(target=ev.srcElement),3===target.nodeType&&(target=target.parentNode),target&&"OBJECT"===target.nodeName.toUpperCase()&&"application/x-shockwave-flash"===target.type||impl.fireEvent(type,target)}},fireEvent:function(e_name,data){var i,handler,handlers;if(e_name=e_name.toLowerCase(),!this.events.hasOwnProperty(e_name))return!1;for(this.public_events.hasOwnProperty(e_name)&&dispatchEvent(this.public_events[e_name],data),handlers=this.events[e_name],i=0;i<handlers.length;i++)try{handler=handlers[i],handler.fn.call(handler.scope,data,handler.cb_data)}catch(err){BOOMR.addError(err,"fireEvent."+e_name+"<"+i+">")}return!0}},boomr={t_lstart:null,t_start:BOOMR_start,t_end:null,url:myurl,utils:{objectToString:function(o,separator,nest_level){var k,value=[];if(!o||"object"!=typeof o)return o;if(void 0===separator&&(separator="\n	"),nest_level||(nest_level=0),"[object Array]"===Object.prototype.toString.call(o)){for(k=0;k<o.length;k++)nest_level>0&&null!==o[k]&&"object"==typeof o[k]?value.push(this.objectToString(o[k],separator+("\n	"===separator?"	":""),nest_level-1)):"&"===separator?value.push(encodeURIComponent(o[k])):value.push(o[k]);separator=","}else for(k in o)Object.prototype.hasOwnProperty.call(o,k)&&(nest_level>0&&null!==o[k]&&"object"==typeof o[k]?value.push(encodeURIComponent(k)+"="+this.objectToString(o[k],separator+("\n	"===separator?"	":""),nest_level-1)):"&"===separator?value.push(encodeURIComponent(k)+"="+encodeURIComponent(o[k])):value.push(k+"="+o[k]));return value.join(separator)},getCookie:function(name){if(!name)return null;name=" "+name+"=";var i,cookies;return cookies=" "+d.cookie+";",(i=cookies.indexOf(name))>=0?(i+=name.length,cookies=cookies.substring(i,cookies.indexOf(";",i))):null},setCookie:function(name,subcookies,max_age){var value,nameval,savedval,c,exp;if(!name||!impl.site_domain)return BOOMR.debug("No cookie name or site domain: "+name+"/"+impl.site_domain),!1;if(value=this.objectToString(subcookies,"&"),nameval=name+"="+value,c=[nameval,"path=/","domain="+impl.site_domain],max_age&&(exp=new Date,exp.setTime(exp.getTime()+1e3*max_age),exp=exp.toGMTString(),c.push("expires="+exp)),nameval.length<500){if(d.cookie=c.join("; "),savedval=this.getCookie(name),value===savedval)return!0;BOOMR.warn("Saved cookie value doesn't match what we tried to set:\n"+value+"\n"+savedval)}else BOOMR.warn("Cookie too long: "+nameval.length+" "+nameval);return!1},getSubCookies:function(cookie){var cookies_a,i,l,kv,gotcookies=!1,cookies={};if(!cookie)return null;if("string"!=typeof cookie)return BOOMR.debug("TypeError: cookie is not a string: "+typeof cookie),null;for(cookies_a=cookie.split("&"),i=0,l=cookies_a.length;l>i;i++)kv=cookies_a[i].split("="),kv[0]&&(kv.push(""),cookies[decodeURIComponent(kv[0])]=decodeURIComponent(kv[1]),gotcookies=!0);return gotcookies?cookies:null},removeCookie:function(name){return this.setCookie(name,{},-86400)},cleanupURL:function(url){return url?impl.strip_query_string?url.replace(/\?.*/,"?qs-redacted"):url:""},hashQueryString:function(url,stripHash){return url?url.match?(url.match(/^\/\//)&&(url=location.protocol+url),url.match(/^(https?|file):/)?(stripHash&&(url=url.replace(/#.*/,"")),BOOMR.utils.MD5?url.replace(/\?([^#]*)/,function(m0,m1){return"?"+(m1.length>10?BOOMR.utils.MD5(m1):m1)}):url):(BOOMR.error("Passed in URL is invalid: "+url),"")):(BOOMR.addError("TypeError: Not a string","hashQueryString",typeof url),""):url},pluginConfig:function(o,config,plugin_name,properties){var i,props=0;if(!config||!config[plugin_name])return!1;for(i=0;i<properties.length;i++)void 0!==config[plugin_name][properties[i]]&&(o[properties[i]]=config[plugin_name][properties[i]],props++);return props>0},addObserver:function(el,config,timeout,callback,callback_data,callback_ctx){function done(mutations){var run_again=!1;o.timer&&(clearTimeout(o.timer),o.timer=null),callback&&(run_again=callback.call(callback_ctx,mutations,callback_data),run_again||(callback=null)),!run_again&&o.observer&&(o.observer.disconnect(),o.observer=null),"number"==typeof run_again&&run_again>0&&(o.timer=setTimeout(done,run_again))}var o={observer:null,timer:null};return window.MutationObserver&&callback&&el?(o.observer=new MutationObserver(done),timeout&&(o.timer=setTimeout(done,o.timeout)),o.observer.observe(el,config),o):null},addListener:function(el,type,fn){el.addEventListener?el.addEventListener(type,fn,!1):el.attachEvent&&el.attachEvent("on"+type,fn)},removeListener:function(el,type,fn){el.removeEventListener?el.removeEventListener(type,fn,!1):el.detachEvent&&el.detachEvent("on"+type,fn)},pushVars:function(form,vars,prefix){var k,i,input,l=0;for(k in vars)if(vars.hasOwnProperty(k))if("[object Array]"===Object.prototype.toString.call(vars[k]))for(i=0;i<vars[k].length;++i)l+=BOOMR.utils.pushVars(form,vars[k][i],k+"["+i+"]");else input=document.createElement("input"),input.type="hidden",input.name=prefix?prefix+"["+k+"]":k,input.value=void 0===vars[k]||null===vars[k]?"":vars[k],form.appendChild(input),l+=encodeURIComponent(input.name).length+encodeURIComponent(input.value).length+2;return l},sendData:function(form,method){function remove(id){var el=document.getElementById(id);el&&el.parentNode.removeChild(el)}function submit(){var iframe,name="boomerang_post-"+encodeURIComponent(form.action)+"-"+Math.random();try{iframe=document.createElement('<iframe name="'+name+'">')}catch(ignore){iframe=document.createElement("iframe")}form.action=urls.shift(),form.target=iframe.name=iframe.id=name,iframe.style.display=form.style.display="none",iframe.src="javascript:false",remove(iframe.id),remove(form.id),document.body.appendChild(iframe),document.body.appendChild(form),form.submit(),urls.length&&BOOMR.setImmediate(submit),setTimeout(function(){remove(iframe.id)},1e4)}var urls=(document.createElement("input"),[impl.beacon_url]);form.method=method,form.id="beacon_form",form.enctype="application/x-www-form-urlencoded",impl.secondary_beacons&&impl.secondary_beacons.length&&urls.push.apply(urls,impl.secondary_beacons),submit()}},init:function(config){var i,k,properties=["beacon_url","beacon_type","site_domain","user_ip","strip_query_string","secondary_beacons"];for(BOOMR_check_doc_domain(),config||(config={}),i=0;i<properties.length;i++)void 0!==config[properties[i]]&&(impl[properties[i]]=config[properties[i]]);void 0!==config.log&&(this.log=config.log),this.log||(this.log=function(){});for(k in this.plugins)if(this.plugins.hasOwnProperty(k)){if(config[k]&&config[k].hasOwnProperty("enabled")&&config[k].enabled===!1){impl.disabled_plugins[k]=1;continue}if(impl.disabled_plugins[k]){if(!config[k]||!config[k].hasOwnProperty("enabled")||config[k].enabled!==!0)continue;delete impl.disabled_plugins[k]}if("function"==typeof this.plugins[k].init)try{this.plugins[k].init(config)}catch(err){BOOMR.addError(err,k+".init")}}return impl.handlers_attached?this:(impl.onloadfired||void 0!==config.autorun&&config.autorun===!1||(d.readyState&&"complete"===d.readyState?(BOOMR.loadedLate=!0,this.setImmediate(BOOMR.page_ready,null,null,BOOMR)):w.onpagehide||null===w.onpagehide?BOOMR.utils.addListener(w,"pageshow",BOOMR.page_ready):BOOMR.utils.addListener(w,"load",BOOMR.page_ready)),BOOMR.utils.addListener(w,"DOMContentLoaded",function(){impl.fireEvent("dom_loaded")}),function(){var forms,iterator;for(void 0!==visibilityChange&&(BOOMR.utils.addListener(d,visibilityChange,function(){impl.fireEvent("visibility_changed")}),BOOMR.subscribe("visibility_changed",function(){BOOMR.lastVisibilityEvent[BOOMR.visibilityState()]=BOOMR.now()})),BOOMR.utils.addListener(d,"mouseup",impl.xb_handler("click")),forms=d.getElementsByTagName("form"),iterator=0;iterator<forms.length;iterator++)BOOMR.utils.addListener(forms[iterator],"submit",impl.xb_handler("form_submit"));w.onpagehide||null===w.onpagehide||BOOMR.utils.addListener(w,"unload",function(){BOOMR.window=w=null})}(),impl.handlers_attached=!0,this)},page_ready:function(ev){return ev||(ev=w.event),ev||(ev={name:"load"}),impl.onloadfired?this:(impl.fireEvent("page_ready",ev),impl.onloadfired=!0,this)},setImmediate:function(fn,data,cb_data,cb_scope){var cb=function(){fn.call(cb_scope||null,data,cb_data||{}),cb=null};w.setImmediate?w.setImmediate(cb):w.msSetImmediate?w.msSetImmediate(cb):w.webkitSetImmediate?w.webkitSetImmediate(cb):w.mozSetImmediate?w.mozSetImmediate(cb):setTimeout(cb,10)},now:function(){try{if("performance"in window&&window.performance&&window.performance.now)return function(){return Math.round(window.performance.now()+window.performance.timing.navigationStart)}}catch(ignore){}return Date.now||function(){return(new Date).getTime()}}(),visibilityState:void 0===visibilityState?function(){return"visible"}:function(){return d[visibilityState]},lastVisibilityEvent:{},subscribe:function(e_name,fn,cb_data,cb_scope){var i,handler,ev,unload_handler;if(e_name=e_name.toLowerCase(),!impl.events.hasOwnProperty(e_name))return this;for(ev=impl.events[e_name],i=0;i<ev.length;i++)if(handler=ev[i],handler&&handler.fn===fn&&handler.cb_data===cb_data&&handler.scope===cb_scope)return this;return ev.push({fn:fn,cb_data:cb_data||{},scope:cb_scope||null}),"page_ready"===e_name&&impl.onloadfired&&this.setImmediate(fn,null,cb_data,cb_scope),("page_unload"===e_name||"before_unload"===e_name)&&(unload_handler=function(evt){fn&&fn.call(cb_scope,evt||w.event,cb_data)},"page_unload"===e_name&&(w.onpagehide||null===w.onpagehide?BOOMR.utils.addListener(w,"pagehide",unload_handler):BOOMR.utils.addListener(w,"unload",unload_handler)),BOOMR.utils.addListener(w,"beforeunload",unload_handler)),this},addError:function(err,src,extra){var str;"string"!=typeof err&&(str=String(err),str.match(/^\[object/)&&(str=err.name+": "+(err.description||err.message).replace(/\r\n$/,"")),err=str),void 0!==src&&(err="["+src+":"+BOOMR.now()+"] "+err),extra&&(err+=":: "+extra),impl.errors[err]?impl.errors[err]++:impl.errors[err]=1},addVar:function(name,value){if("string"==typeof name)impl.vars[name]=value;else if("object"==typeof name){var k,o=name;for(k in o)o.hasOwnProperty(k)&&(impl.vars[k]=o[k])}return this},removeVar:function(arg0){var i,params;if(!arguments.length)return this;for(params=1===arguments.length&&"[object Array]"===Object.prototype.toString.apply(arg0)?arg0:arguments,i=0;i<params.length;i++)impl.vars.hasOwnProperty(params[i])&&delete impl.vars[params[i]];return this},hasVar:function(name){return impl.vars.hasOwnProperty(name)},requestStart:function(name){var t_start=BOOMR.now();return BOOMR.plugins.RT.startTimer("xhr_"+name,t_start),{loaded:function(data){BOOMR.responseEnd(name,t_start,data)}}},responseEnd:function(name,t_start,data){"object"==typeof name&&name.url?impl.fireEvent("xhr_load",name):(BOOMR.plugins.RT.startTimer("xhr_"+name,t_start),impl.fireEvent("xhr_load",{name:"xhr_"+name,data:data}))},sendBeacon:function(){var k,form,length,errors=[];BOOMR.debug("Checking if we can send beacon");for(k in this.plugins)if(this.plugins.hasOwnProperty(k)){if(impl.disabled_plugins[k])continue;if(!this.plugins[k].is_complete())return BOOMR.debug("Plugin "+k+" is not complete, deferring beacon send"),!1}impl.vars.pgu=BOOMR.utils.cleanupURL(d.URL.replace(/#.*/,"")),impl.vars.u||(impl.vars.u=impl.vars.pgu),impl.vars.pgu===impl.vars.u&&delete impl.vars.pgu,impl.vars.v=BOOMR.version,BOOMR.visibilityState()&&(impl.vars["vis.st"]=BOOMR.visibilityState(),BOOMR.lastVisibilityEvent.visible&&(impl.vars["vis.lv"]=BOOMR.now()-BOOMR.lastVisibilityEvent.visible),BOOMR.lastVisibilityEvent.hidden&&(impl.vars["vis.lh"]=BOOMR.now()-BOOMR.lastVisibilityEvent.hidden)),w!==window&&(impl.vars["if"]="");for(k in impl.errors)impl.errors.hasOwnProperty(k)&&errors.push(k+(impl.errors[k]>1?" (*"+impl.errors[k]+")":""));return errors.length>0&&(impl.vars.errors=errors.join("\n")),impl.errors={},impl.fireEvent("before_beacon",impl.vars),BOOMR.debug("Ready to send beacon: "+BOOMR.utils.objectToString(impl.vars)),impl.beacon_url?(form=document.createElement("form"),length=BOOMR.utils.pushVars(form,impl.vars),impl.fireEvent("onbeacon",impl.vars),length?(BOOMR.utils.sendData(form,"AUTO"===impl.beacon_type?length>2e3?"POST":"GET":"POST"),!0):this):(BOOMR.debug("No beacon URL, so skipping."),!0)}},delete BOOMR_start,"number"==typeof BOOMR_lstart?(boomr.t_lstart=BOOMR_lstart,delete BOOMR_lstart):"number"==typeof BOOMR.window.BOOMR_lstart&&(boomr.t_lstart=BOOMR.window.BOOMR_lstart),function(){var make_logger;"object"==typeof console&&void 0!==console.log&&(boomr.log=function(m,l,s){console.log(s+": ["+l+"] "+m)}),make_logger=function(l){return function(m,s){return this.log(m,l,"boomerang"+(s?"."+s:"")),this}},boomr.debug=make_logger("debug"),boomr.info=make_logger("info"),boomr.warn=make_logger("warn"),boomr.error=make_logger("error")}(),function(){var ident;for(ident in boomr)boomr.hasOwnProperty(ident)&&(BOOMR[ident]=boomr[ident]);BOOMR.xhr_excludes||(BOOMR.xhr_excludes={})}(),dispatchEvent("onBoomerangLoaded",{BOOMR:BOOMR},!0))}(window),function(w){var impl,d=w.document;BOOMR=BOOMR||{},BOOMR.plugins=BOOMR.plugins||{},BOOMR.plugins.RT||(impl={onloadfired:!1,unloadfired:!1,visiblefired:!1,initialized:!1,complete:!1,timers:{},cookie:"RT",cookie_exp:600,strict_referrer:!0,navigationType:0,navigationStart:void 0,responseStart:void 0,t_start:void 0,cached_t_start:void 0,t_fb_approx:void 0,r:void 0,r2:void 0,basic_timers:{t_done:1,t_resp:1,t_page:1},addedVars:[],updateCookie:function(params,timer){var t_end,t_start,subcookies,k;if(!this.cookie)return!1;if(subcookies=BOOMR.utils.getSubCookies(BOOMR.utils.getCookie(this.cookie))||{},"object"==typeof params)for(k in params)params.hasOwnProperty(k)&&(void 0===params[k]?subcookies.hasOwnProperty(k)&&delete subcookies[k]:(("nu"===k||"r"===k)&&(params[k]=BOOMR.utils.hashQueryString(params[k],!0)),subcookies[k]=params[k]));return t_start=BOOMR.now(),timer&&(subcookies[timer]=t_start),BOOMR.debug("Setting cookie (timer="+timer+")\n"+BOOMR.utils.objectToString(subcookies),"rt"),BOOMR.utils.setCookie(this.cookie,subcookies,this.cookie_exp)?(t_end=BOOMR.now(),t_end-t_start>50&&(BOOMR.utils.removeCookie(this.cookie),BOOMR.error("took more than 50ms to set cookie... aborting: "+t_start+" -> "+t_end,"rt")),!0):(BOOMR.error("cannot set start cookie","rt"),!1)},initFromCookie:function(){var url,subcookies;subcookies=BOOMR.utils.getSubCookies(BOOMR.utils.getCookie(this.cookie)),subcookies&&(subcookies.s=Math.max(+subcookies.ul||0,+subcookies.cl||0),BOOMR.debug("Read from cookie "+BOOMR.utils.objectToString(subcookies),"rt"),subcookies.s&&(subcookies.r||subcookies.nu)&&(this.r=subcookies.r,url=BOOMR.utils.hashQueryString(d.URL,!0),BOOMR.debug(this.r+" =?= "+this.r2,"rt"),BOOMR.debug(subcookies.s+" <? "+(+subcookies.cl+15),"rt"),BOOMR.debug(subcookies.nu+" =?= "+url,"rt"),!this.strict_referrer||subcookies.nu&&subcookies.nu===url&&subcookies.s<+subcookies.cl+15||subcookies.s===+subcookies.ul&&this.r===this.r2?(this.t_start=subcookies.s,+subcookies.hd>subcookies.s&&(this.t_fb_approx=parseInt(subcookies.hd,10))):this.t_start=this.t_fb_approx=void 0),this.updateCookie({s:void 0,r:void 0,nu:void 0,ul:void 0,cl:void 0,hd:void 0}))},getBoomerangTimings:function(){function trimTiming(time,st){var timeMs=Math.round(time?time:0),startTimeMs=Math.round(st?st:0);return timeMs=0===timeMs?0:timeMs-startTimeMs,timeMs?timeMs:""}var res,urls,url,startTime,data;BOOMR.t_start&&(BOOMR.plugins.RT.startTimer("boomerang",BOOMR.t_start),BOOMR.plugins.RT.endTimer("boomerang",BOOMR.t_end),BOOMR.plugins.RT.endTimer("boomr_fb",BOOMR.t_start),BOOMR.t_lstart&&(BOOMR.plugins.RT.endTimer("boomr_ld",BOOMR.t_lstart),BOOMR.plugins.RT.setTimer("boomr_lat",BOOMR.t_start-BOOMR.t_lstart)));try{if(window.performance&&window.performance.getEntriesByName){urls={"rt.bmr":BOOMR.url};for(url in urls)if(urls.hasOwnProperty(url)&&urls[url]){if(res=window.performance.getEntriesByName(urls[url]),!res||0===res.length)continue;res=res[0],startTime=trimTiming(res.startTime,0),data=[startTime,trimTiming(res.responseEnd,startTime),trimTiming(res.responseStart,startTime),trimTiming(res.requestStart,startTime),trimTiming(res.connectEnd,startTime),trimTiming(res.secureConnectionStart,startTime),trimTiming(res.connectStart,startTime),trimTiming(res.domainLookupEnd,startTime),trimTiming(res.domainLookupStart,startTime),trimTiming(res.redirectEnd,startTime),trimTiming(res.redirectStart,startTime)].join(",").replace(/,+$/,""),BOOMR.addVar(url,data),impl.addedVars.push(url)}}}catch(e){BOOMR.addError(e,"rt.getBoomerangTimings")}},checkPreRender:function(){return"prerender"!==BOOMR.visibilityState()?!1:(BOOMR.plugins.RT.startTimer("t_load",this.navigationStart),BOOMR.plugins.RT.endTimer("t_load"),BOOMR.plugins.RT.startTimer("t_prerender",this.navigationStart),BOOMR.plugins.RT.startTimer("t_postrender"),!0)},initFromNavTiming:function(){var ti,p,source;this.navigationStart||(p=w.performance||w.msPerformance||w.webkitPerformance||w.mozPerformance,p&&p.navigation&&(this.navigationType=p.navigation.type),p&&p.timing?ti=p.timing:w.chrome&&w.chrome.csi&&w.chrome.csi().startE?(ti={navigationStart:w.chrome.csi().startE},source="csi"):w.gtbExternal&&w.gtbExternal.startE()&&(ti={navigationStart:w.gtbExternal.startE()},source="gtb"),ti?(BOOMR.addVar("rt.start",source||"navigation"),this.navigationStart=ti.navigationStart||ti.fetchStart||void 0,this.responseStart=ti.responseStart||void 0,navigator.userAgent.match(/Firefox\/[78]\./)&&(this.navigationStart=ti.unloadEventStart||ti.fetchStart||void 0)):BOOMR.warn("This browser doesn't support the WebTiming API","rt"))},validateLoadTimestamp:function(t_now,data){var t_done=t_now;return data&&data.timing&&data.timing.loadEventEnd?t_done=data.timing.loadEventEnd:BOOMR.loadedLate&&(w.performance&&w.performance.timing?w.performance.timing.loadEventStart&&w.performance.timing.loadEventStart<BOOMR.t_end&&(t_done=w.performance.timing.loadEventStart):t_done=BOOMR.t_lstart||BOOMR.t_start||t_now),t_done},setPageLoadTimers:function(ename,t_done,data){var t_resp_start;return"xhr"!==ename&&(impl.initFromCookie(),impl.initFromNavTiming(),impl.checkPreRender())?!1:("xhr"===ename?data&&data.timing&&(t_resp_start=data.timing.responseStart):impl.responseStart?t_resp_start=impl.responseStart:impl.timers.hasOwnProperty("t_page")?BOOMR.plugins.RT.endTimer("t_page"):impl.t_fb_approx&&(t_resp_start=impl.t_fb_approx),t_resp_start&&(BOOMR.plugins.RT.endTimer("t_resp",t_resp_start),impl.timers.t_load?BOOMR.plugins.RT.setTimer("t_page",impl.timers.t_load.end-t_resp_start):BOOMR.plugins.RT.setTimer("t_page",t_done-t_resp_start)),impl.timers.hasOwnProperty("t_postrender")&&(BOOMR.plugins.RT.endTimer("t_postrender"),BOOMR.plugins.RT.endTimer("t_prerender")),!0)},setSupportingTimestamps:function(t_start){t_start&&BOOMR.addVar("rt.tstart",t_start),"number"==typeof impl.t_start&&impl.t_start!==t_start&&BOOMR.addVar("rt.cstart",impl.t_start),BOOMR.addVar("rt.bstart",BOOMR.t_start),BOOMR.t_lstart&&BOOMR.addVar("rt.blstart",BOOMR.t_lstart),BOOMR.addVar("rt.end",impl.timers.t_done.end)},determineTStart:function(ename,data){var t_start;return"xhr"===ename?(data&&data.name&&impl.timers[data.name]?t_start=impl.timers[data.name].start:data&&data.timing&&data.timing.requestStart&&(t_start=data.timing.requestStart),BOOMR.addVar("rt.start","manual")):impl.navigationStart?t_start=impl.navigationStart:impl.t_start&&2!==impl.navigationType?(t_start=impl.t_start,BOOMR.addVar("rt.start","cookie")):impl.cached_t_start?t_start=impl.cached_t_start:(BOOMR.addVar("rt.start","none"),t_start=void 0),BOOMR.debug("Got start time: "+t_start,"rt"),impl.cached_t_start=t_start,t_start},page_ready:function(){this.onloadfired=!0},check_visibility:function(){"visible"===BOOMR.visibilityState()&&(impl.visiblefired=!0),"prerender"===impl.visibilityState&&"prerender"!==BOOMR.visibilityState()&&BOOMR.plugins.RT.done(null,"visible"),impl.visibilityState=BOOMR.visibilityState()},page_unload:function(edata){BOOMR.debug("Unload called with "+BOOMR.utils.objectToString(edata)+" when unloadfired = "+this.unloadfired,"rt"),this.unloadfired||BOOMR.plugins.RT.done(edata,"unload"),this.updateCookie({r:d.URL},"beforeunload"===edata.type?"ul":"hd"),this.unloadfired=!0},_iterable_click:function(name,element,etarget,value_cb){var value;if(etarget){for(BOOMR.debug(name+" called with "+etarget.nodeName,"rt");etarget&&etarget.nodeName.toUpperCase()!==element;)etarget=etarget.parentNode;etarget&&etarget.nodeName.toUpperCase()===element&&(BOOMR.debug("passing through","rt"),value=value_cb(etarget),this.updateCookie({nu:value},"cl"),BOOMR.addVar("nu",BOOMR.utils.cleanupURL(value)),impl.addedVars.push("nu"))}},onclick:function(etarget){impl._iterable_click("Click","A",etarget,function(t){return t.href})},onsubmit:function(etarget){impl._iterable_click("Submit","FORM",etarget,function(t){var v=t.getAttribute("action")||d.URL||"";return v.match(/\?/)?v:v+"?"})},domloaded:function(){BOOMR.plugins.RT.endTimer("t_domloaded")},clear:function(vars){impl.addedVars&&impl.addedVars.length>0&&(BOOMR.removeVar(impl.addedVars),impl.addedVars=[])}},BOOMR.plugins.RT={init:function(config){return BOOMR.debug("init RT","rt"),w!==BOOMR.window&&(w=BOOMR.window),d=w.document,BOOMR.utils.pluginConfig(impl,config,"RT",["cookie","cookie_exp","strict_referrer"]),impl.r=impl.r2=BOOMR.utils.hashQueryString(d.referrer,!0),impl.initFromCookie(),impl.getBoomerangTimings(),impl.initialized?this:(impl.complete=!1,impl.timers={},impl.check_visibility(),BOOMR.subscribe("page_ready",impl.page_ready,null,impl),BOOMR.subscribe("visibility_changed",impl.check_visibility,null,impl),BOOMR.subscribe("page_ready",this.done,"load",this),BOOMR.subscribe("xhr_load",this.done,"xhr",this),BOOMR.subscribe("dom_loaded",impl.domloaded,null,impl),BOOMR.subscribe("page_unload",impl.page_unload,null,impl),BOOMR.subscribe("click",impl.onclick,null,impl),BOOMR.subscribe("form_submit",impl.onsubmit,null,impl),BOOMR.subscribe("before_beacon",this.addTimersToBeacon,"beacon",this),BOOMR.subscribe("onbeacon",impl.clear,null,impl),impl.initialized=!0,this)},startTimer:function(timer_name,time_value){return timer_name&&("t_page"===timer_name&&this.endTimer("t_resp",time_value),impl.timers[timer_name]={start:"number"==typeof time_value?time_value:BOOMR.now()}),this},endTimer:function(timer_name,time_value){return timer_name&&(impl.timers[timer_name]=impl.timers[timer_name]||{},void 0===impl.timers[timer_name].end&&(impl.timers[timer_name].end="number"==typeof time_value?time_value:BOOMR.now())),this},setTimer:function(timer_name,time_delta){return timer_name&&(impl.timers[timer_name]={delta:time_delta}),this},addTimersToBeacon:function(vars,source){var t_name,timer,t_other=[];for(t_name in impl.timers)if(impl.timers.hasOwnProperty(t_name)){if(timer=impl.timers[t_name],"number"!=typeof timer.delta&&("number"!=typeof timer.start&&(timer.start=impl.cached_t_start),timer.delta=timer.end-timer.start),isNaN(timer.delta))continue;impl.basic_timers.hasOwnProperty(t_name)?(BOOMR.addVar(t_name,timer.delta),impl.addedVars.push(t_name)):t_other.push(t_name+"|"+timer.delta)}t_other.length&&(BOOMR.addVar("t_other",t_other.join(",")),impl.addedVars.push("t_other")),"beacon"===source&&(impl.timers={},impl.complete=!1)},done:function(edata,ename){try{BOOMR.debug("Called done with "+BOOMR.utils.objectToString(edata,void 0,1)+", "+ename,"rt")}catch(err){BOOMR.debug("Called done with "+err+", "+ename,"rt")}var t_start,t_done,t_now=BOOMR.now(),subresource=!1;return impl.complete=!1,t_done=impl.validateLoadTimestamp(t_now,edata),"load"!==ename&&"visible"!==ename&&"xhr"!==ename||impl.setPageLoadTimers(ename,t_done,edata)?(t_start=impl.determineTStart(ename,edata),edata&&edata.data&&(edata=edata.data),"xhr"===ename&&edata&&(subresource=edata.subresource),this.endTimer("t_done",t_done),BOOMR.removeVar("t_done","t_page","t_resp","t_postrender","t_prerender","t_load","t_other","r","r2","rt.tstart","rt.cstart","rt.bstart","rt.end","rt.subres","rt.abld","http.errno","http.method","xhr.sync"),impl.setSupportingTimestamps(t_start),this.addTimersToBeacon(),BOOMR.addVar("r",BOOMR.utils.cleanupURL(impl.r)),impl.r2!==impl.r&&BOOMR.addVar("r2",BOOMR.utils.cleanupURL(impl.r2)),"xhr"===ename&&edata&&edata&&edata.data&&(edata=edata.data),"xhr"===ename&&edata&&(subresource=edata.subresource,edata.url&&(BOOMR.addVar("u",BOOMR.utils.cleanupURL(edata.url.replace(/#.*/,""))),impl.addedVars.push("u")),edata.status&&(edata.status<-1||edata.status>=400)&&BOOMR.addVar("http.errno",edata.status),edata.method&&"GET"!==edata.method&&BOOMR.addVar("http.method",edata.method),edata.headers&&BOOMR.addVar("http.hdr",edata.headers),edata.synchronous&&BOOMR.addVar("xhr.sync",1),edata.initiator&&BOOMR.addVar("http.initiator",edata.initiator),impl.addedVars.push("http.errno","http.method","http.hdr","xhr.sync","http.initiator")),subresource&&(BOOMR.addVar("rt.subres",1),impl.addedVars.push("rt.subres")),impl.updateCookie(),"unload"===ename&&(BOOMR.addVar("rt.quit",""),impl.onloadfired||BOOMR.addVar("rt.abld",""),impl.visiblefired||BOOMR.addVar("rt.ntvu","")),impl.complete=!0,BOOMR.sendBeacon(),this):this},is_complete:function(){return impl.complete}})}(window);var GA=function(){this.bucket=[1e3,1500,2e3,2500,3e3,3500,4e3,4500,5e3,5500,6e3,6500,7e3,7500,8e3,9e3,1e4,15e3,2e4,3e4,45e3,6e4],this.pageTitle=window.document.title};GA.prototype.trackInAnalytics=function(beacon){var self=this;if(beacon.t_done&&!(beacon.t_done<0)){var timeTaken=beacon.t_done;ga("send","event","PageLoad",self.getBucket(timeTaken),self.pageTitle,timeTaken,{nonInteraction:1})}},GA.prototype.getBucket=function(timeTaken){var self=this,bucketString="> "+self.bucket[self.bucket.length-1]/1e3+"s";for(b in self.bucket)if(timeTaken<self.bucket[b]){bucketString="< "+self.bucket[b]/1e3+"s";break}return bucketString},function(w){w.document;BOOMR=BOOMR||{},BOOMR.plugins=BOOMR.plugins||{},BOOMR.plugins.GA||(BOOMR.plugins.ga={init:function(config){var ga=new GA;return BOOMR.subscribe("before_beacon",ga.trackInAnalytics),this}})}(window);
//# sourceMappingURL=boomerang-0.9.0-pm-debug.min.js.map